sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/DateFormat","sap/m/Select","sap/m/MessageBox","sap/m/MessageToast","sap/m/Table","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/model/odata/type/Time","sap/suite/ui/generic/template/lib/testableHelper","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/suite/ui/generic/template/lib/modelHelper"],function(q,B,D,S,M,a,T,F,b,c,d,t,J,V,m){"use strict";function g(p,C){var s="";var f=[];var i;return function(o){var l=C;var j=p;var n;for(var h in f){if(f[h].path===p){n=f[h];break;}}if(!n){var r=o.getModel("entitySet").getMetaModel();var u=r.getObject(r.getMetaContext(o.sPath).sPath);var P=r.getObject(r.getMetaContext(o.sPath+"/"+p).sPath);if(P){var v=" ";for(var k=0;P.extensions&&k<P.extensions.length;k++){if(P.extensions[k].namespace==="http://www.sap.com/Protocols/SAPData"){switch(P.extensions[k].name){case"display-format":v=P.extensions[k].value;break;case"label":if(!l){l=P.extensions[k].value;}break;case"text":var w=P.extensions[k].value;var x=p.split("/");x[x.length-1]=w;j=x.join("/");break;default:break;}}}if(l===""||l===undefined){l=p;}i=sap.suite.ui.generic.template.js.AnnotationHelper.getTextArrangement(u,P);n={path:p,data:{type:P.type,displayFormat:v,label:l,textPath:j,textArrangement:i}};f.push(n);}}l=n.data.label;var y=o.getProperty(p);var A;if(n.data.textPath&&n.data.textPath!==""){A=o.getProperty(n.data.textPath);}switch(n.data.type){case"Edm.DateTime":if(n.data.displayFormat==="Date"){var z=D.getDateInstance({style:"medium"});var E=new Date(0).getTimezoneOffset()*60*1000;if(y&&y!==""&&y.getTime){y=z.format(new Date(y.getTime()+E));}}break;case"Edm.Time":if(y&&y!==""){var G=new d();y=G.formatValue(y,"string");}break;case"Edm.Boolean":if(y===true){y="{i18n>YES}";}else if(y===false){y="{i18n>NO}";}break;default:break;}if(!A||n.data.textPath===p){s=y?y:"";}else{switch(n.data.textArrangement){case"idAndDescription":s=y+" ("+A+")";break;case"idOnly":s=y;break;case"descriptionOnly":s=A;break;default:s=A+(y?" ("+y+")":"");break;}}return{key:s?s:p,text:l?l+": "+s:s};};}function e(C,o,s,f){function E(i){var j={};for(var k in i){var x=i[k];if(typeof x==="string"){j[k]=x;}else if(typeof x==="object"){if(x.value){j[k]=E(x).value;}else{j[k]=x;}}}return j;}function h(i){if(i instanceof sap.ui.generic.app.navigation.service.NavError){if(i.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){sap.m.MessageBox.show(f.getText("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:f.getText("ST_GENERIC_ERROR_TITLE")});}else{sap.m.MessageBox.show(i.getErrorCode(),{title:f.getText("ST_GENERIC_ERROR_TITLE")});}}}function l(){var i=C.getView().getBindingContext();return s.oApplication.getDraftSiblingPromise(i);}function n(j){var k=j;var x=-1;var w1=f.getOwnerControl(j);if(w1.getTable){w1=w1.getTable();}var x1=f.isAnalyticalTable(w1);var y1=o.getViewLevel();var z1;if(!x1){var A1=f.getTableBindingInfo(w1);var B1=A1&&A1.binding;var C1=null;if(B1){if(f.isTreeTable(w1)){var D1=(B1.getLength()>0)?B1.getLength():0;if(D1>0){C1=[];for(var E1=0;E1<D1;E1++){C1.push(B1.getContextByIndex(E1));}}}else if(f.isUiTable(w1)){C1=B1.getContexts();}else if(w1 instanceof T){C1=B1.getCurrentContexts();}}var F1=null;var G1=f.getSelectedContexts(w1);var H1=null;if(G1&&G1.length>0){H1=G1[0].getPath();}else if(k){H1=k.getBindingContext()?k.getBindingContext().sPath:null;}if(B1&&B1.getContexts&&H1){for(var i=0;i<C1.length;i++){F1=C1[i];if(F1.getPath()===H1){x=i;break;}}}if(w1&&x!==-1&&C1.length>0){var I1;if(w1 instanceof T){I1=w1.getGrowingThreshold();}else if(f.isUiTable(w1)){I1=w1.getThreshold();}var J1=y1>0?f.getTableBindingInfo(w1).path:null;var K1=function(L1){return{context:L1,navigationData:{navigationProperty:J1}};};z1=C1&&{listBinding:B1,growingThreshold:I1,selectedRelativeIndex:x,objectPageNavigationContexts:C1,navigitionInfoProvider:K1};}}o.setPaginatorInfo(z1,true);}function p(j,k){var x=C.getView().getModel().getMetaModel();var w1=k;var x1=x.getODataEntitySet(j,false);var y1=x.getODataEntityType(x1.entityType,false);var z1=y1.key.propertyRef;var i;var A1=s.oDraftController.getDraftContext();if(A1.isDraftEnabled(j)){z1=z1.concat(A1.getSemanticKey(j));z1.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(w1.parameters.select&&w1.parameters.select.length>0){var B1=w1.parameters.select.split(",");for(i=0;i<z1.length;i++){if(q.inArray(z1[i].name,B1)===-1){w1.parameters.select+=","+z1[i].name;B1=w1.parameters.select.split(",");}}}return w1;}function r(i,j){var k=i.getSource().getUrl();i.preventDefault();f.processDataLossConfirmationIfNonDraft(function(){sap.m.URLHelper.redirect(k,false);},q.noop,j);}function u(i,j){i.preventDefault();var k=i.getSource().getHref();f.processDataLossConfirmationIfNonDraft(function(){window.location.hash=k;},q.noop,j);}function v(j){var k=[];return f.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(i){var x=i.getSource().getParent();x.close();},onDelete:function(x){var w1=x.getSource().getParent();var x1=w1.getModel("delete");var y1=x1.getProperty("/items");var z1=[];var A1=[];var B1=[];k=[];for(var i=0;i<y1.length;i++){if(!y1[i].draftStatus.locked&&y1[i].deletable){if(!y1[i].draftStatus.draft){if(y1[i].draftStatus.draftActive){B1.push(y1[i].context.sPath);}else if(y1.length===x1.getProperty("/unsavedChangesItemsCount")||!y1[i].draftStatus.unsavedChanges||x1.getProperty("/checkboxSelected")){z1.push(y1[i].context.sPath);}}else{A1.push(y1[i].context.sPath);k.push(y1[i].context.sPath);}}}A1=A1.concat(z1).concat(B1);s.oCRUDManager.deleteEntities(A1).then(function(C1){var D1=0;var E1=[];for(var i=0;i<C1.length;i++){E1.push("/"+C1[i].split('/')[1]);if(k.indexOf(E1[i])!==-1){D1=D1+1;}}var F1=j.getTable();F1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",false);var G1=A1.length-B1.length-(C1.length-D1);if((C1.length-D1)>0){var H1="";if(G1>0){H1+=(G1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL_WITH_COUNT",[G1]):f.getText("ST_GENERIC_DELETE_SUCCESS_WITH_COUNT",[G1]);H1+="\n";H1+=(C1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL_WITH_COUNT",[C1.length]):f.getText("ST_GENERIC_DELETE_ERROR_WITH_COUNT",[C1.length]);}else{H1=(C1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):f.getText("ST_GENERIC_DELETE_ERROR");}M.error(H1);}else{var I1="";I1=(G1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):f.getText("ST_GENERIC_OBJECT_DELETED");s.oApplication.showMessageToast(I1);}f.refreshSmartTable(j);},function(C1){M.error(f.getText("ST_GENERIC_DELETE_ERROR_PLURAL",[A1.length]),{styleClass:f.getContentDensityClass()});});w1.close();}},"delete");}function w(i,j){return new Promise(function(k,x){j.read(i+"/SiblingEntity",{success:function(w1){var x1="/"+j.getKey(w1);k(x1);},error:function(w1){var x1="Error";k(x1);}});});}function y(j){var k=C.getView().getModel();var x=k.getMetaModel();var w1=x.getODataEntitySet(C.getOwnerComponent().getEntitySet());var x1=w1["Org.OData.Capabilities.V1.DeleteRestrictions"];var y1=(x1&&x1.Deletable&&x1.Deletable.Path)?x1.Deletable.Path:"";var z1={items:undefined,itemsCount:j.length,text:{title:undefined,shortText:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,checkboxSelected:true};var A1=[];var B1=[];var C1,D1,E1,F1,G1;var H1=[];for(var i=0;i<j.length;i++){C1=k.getObject(j[i].getPath());if(!C1.IsActiveEntity){if(C1.HasActiveEntity){H1.push(w(j[i].getPath(),k));}}}var I1=0;return new Promise(function(J1,K1){Promise.all(H1).then(function(L1){for(var i=0;i<j.length;i++){C1=k.getObject(j[i].getPath());D1={};E1={};F1=true;G1={};if(!C1.IsActiveEntity){D1.draft=true;if(C1.HasActiveEntity){E1.draft=false;E1.draftActive=true;if(L1[I1]!="Error"){G1["oModel"]=j[0].getModel();G1["sPath"]=L1[I1++];}}}else if(C1.HasDraftEntity){var M1=k.getProperty("DraftAdministrativeData/CreatedByUserDescription",j[i]);if(!M1){M1=k.getProperty("DraftAdministrativeData/InProcessByUser",j[i]);}if(M1){D1.locked=true;D1.user=M1;z1.lockedItemsCount++;}else{D1.unsavedChanges=true;D1.user=k.getProperty("DraftAdministrativeData/LastChangedByUser",j[i]);z1.unsavedChangesItemsCount++;}}if(y1&&y1!==""){if(k.getProperty(y1,j[i])===false){F1=false;z1.undeletableCount++;}}A1.push({context:j[i],draftStatus:D1,deletable:F1});if(!C1.IsActiveEntity&&C1.HasActiveEntity){B1.push({context:G1,draftStatus:E1,deletable:F1});}}if(B1.length>0){A1=A1.concat(B1);}z1.items=A1;if(z1.lockedItemsCount===z1.itemsCount){z1.text.title=f.getText("ST_GENERIC_ERROR_TITLE");}else{z1.text.title=(z1.itemsCount>1)?f.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[z1.itemsCount]):f.getText("ST_GENERIC_DELETE_TITLE");}z1.text.unsavedChanges=f.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(z1.itemsCount>1){if(z1.lockedItemsCount===z1.itemsCount){z1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED_PLURAL");}else if(z1.unsavedChangesItemsCount===z1.itemsCount){z1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL");}else if(z1.lockedItemsCount>0){var N1=z1.itemsCount-z1.lockedItemsCount;z1.text.shortText=(z1.lockedItemsCount>1)?f.getText("ST_GENERIC_CURRENTLY_LOCKED_PLURAL",[z1.lockedItemsCount,z1.itemsCount]):f.getText("ST_GENERIC_CURRENTLY_LOCKED",[z1.itemsCount]);z1.text.shortText+="\n";if(N1===z1.unsavedChangesItemsCount){z1.text.shortText+=(N1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL"):f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");}else{z1.text.shortText+=(N1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[N1]):f.getText("ST_GENERIC_DELETE_REMAINING");}}else{z1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED_PLURAL");}if(z1.undeletableCount>0){z1.text.undeletableText=f.getText("ST_GENERIC_DELETE_UNDELETABLE",[z1.undeletableCount,z1.itemsCount]);}}else{if(z1.lockedItemsCount>0){z1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED",[" ",z1.items[0].draftStatus.user]);}else if(z1.unsavedChangesItemsCount>0){z1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",z1.items[0].draftStatus.user]);}else{z1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED");}}J1({"mJSONData":z1});});});}function z(i,j,k,x){var w1=f.getNavigationHandler();var x1={};var y1={};for(var z1 in i.parameters){if(q.isEmptyObject(i.parameters[z1])){x1[z1]=i.parameters[z1];}else{y1[z1]=i.parameters[z1];}}y1=E(y1);w1.mixAttributesAndSelectionVariant({},x).getParameterNames().forEach(function(z1){delete x1[z1];});var A1=k&&k.getObject();var B1=j&&j.getObject?j.getObject():j&&j[0];var C1=q.extend({},x1,A1,B1,y1);return w1.mixAttributesAndSelectionVariant(C1,x);}function N(i,j,k,x){var w1=f.getNavigationHandler();var x1;if(k){x1=k.getUiState().getSelectionVariant();if(typeof x1!=="string"){x1=JSON.stringify(x1);}}var y1=z(i,j,C.getView().getBindingContext(),x1);var z1={semanticObject:i.semanticObject,action:i.action};C.adaptNavigationParameterExtension(y1,z1);w1.navigate(i.semanticObject,i.action,y1.toJSONString(),null,h);}function A(i){var j=f.getNavigationHandler();var k={semanticObject:i.semanticObject,action:i.action};var x=j.mixAttributesAndSelectionVariant(i.semanticAttributes);C.adaptNavigationParameterExtension(x,k);j.navigate(i.semanticObject,i.action,x.toJSONString(),null,h);}function H(i,k){var x=i.byId("icon");var w1=x&&x.getSrc();if(w1===""){w1=undefined;}var x1=i.byId("title");var y1=x1&&x1.getText();if(y1===""){y1=undefined;}var z1=i.byId("description");var A1=z1&&z1.getText();if(A1===""){A1=undefined;}for(var j=0;j<k.length;j++){var B1=k[j];var C1=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(B1)+"::contactTitleAreaIcon";var D1=i.byId(C1);var E1=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(B1)+"::contactTitleAreaTitle";var F1=i.byId(E1);var G1=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(B1)+"::contactTitleAreaDescription";var H1=i.byId(G1);var I1=D1&&D1.getSrc();if(I1===""){I1=undefined;}var J1=F1&&F1.getText();if(J1===""){J1=undefined;}var K1=H1&&H1.getText();if(K1===""){K1=undefined;}if(w1&&I1&&y1&&J1&&A1&&K1){if((w1===I1||!I1)&&(y1===J1||!J1)&&(A1===K1||!K1)){var L1=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(B1)+"::contactTitleArea";var M1=i.byId(L1);if(M1&&M1.setVisible){M1.setVisible(false);}}}}}function G(i,j,k,x){var w1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var x1=w1.crossNavigation.outbounds[i.data("CrossNavigation")];var y1;if(k){if(f.isSmartChart(i)){y1=f.getOwnerControl(x);}else{y1=f.getOwnerControl(i).getParent();}}N(x1,j,k,y1);}function I(j,k){for(var i=0;i<j.length;i++){if(j[i].indexOf("/")!==-1){var x=j[i].split("/");x.pop();var w1=x.join("/");if(k.indexOf(w1)===-1){k.push(w1);}}}}function K(i,j){}function O(i,j){f.processDataLossConfirmationIfNonDraft(function(){var k=i.data('SemanticObject');var x=i.data('Action');var w1=i.data('SemanticAttributes');if(k&&x){var x1={semanticObject:k,action:x};if(w1){w1="{"+w1+"}";x1.semanticAttributes=JSON.parse(w1);}A(x1);}},q.noop);}function L(k,x,w1,x1,y1){var z1="";var A1=function(d2){var e2=d2.dependent.propertyRef;var f2=x.originalId;var g2=C.getView().byId(f2);if(g2&&g2.mProperties.fieldName){for(var h2 in e2){if(e2[h2].name===g2.mProperties.fieldName){z1=g2.mProperties.fieldName;return true;}}}if(!g2){var i2=q("#"+f2.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(i2){g2=i2.control(0);if(g2&&g2.mProperties.fieldName){for(var h2 in e2){if(e2[h2].name===g2.mProperties.fieldName){z1=g2.mProperties.fieldName;return true;}}}}}return false;};var B1=function(){var C1,J1,d2,e2,f2,g2,h2;J1=k.getModel().getMetaModel();d2=J1.getODataEntitySet(k.getEntitySet());e2=J1.getODataEntityType(d2.entityType);if(!e2||!e2.navigationProperty){return;}for(var i=0;i<e2.navigationProperty.length;i++){f2=e2.navigationProperty[i];if(f2.name==="SiblingEntity"||f2.name==="DraftAdministrativeData"){continue;}var i2=f2.relationship;var j2=i2.lastIndexOf(".");var k2=i2.slice(0,j2);var l2=i2.slice(j2+1);var m2=J1.getObject("/dataServices/schema");var n2;for(var j in m2){if(m2[j].namespace===k2){n2=m2[j];break;}}var o2=n2.association;var p2;for(var j in o2){if(o2[j].name===l2){p2=o2[j];break;}}var q2=p2.referentialConstraint;if(q2&&q2.dependent&&q2.dependent.propertyRef){var r2=A1(q2);if(r2){g2=J1.getODataAssociationEnd(e2,f2.name);h2=J1.getODataEntityType(g2.type);var s2=J1.getODataEntityContainer();var t2="";var u2="";var v2="";for(var j=0;j<s2.entitySet.length;j++){var w2=h2.entityType;if(!w2){w2=h2.namespace+"."+h2.name;}if(s2.entitySet[j].entityType===w2){t2=s2.entitySet[j].name;u2=s2.entitySet[j].entityType;break;}}C1={navigation:f2.name,entitySet:t2,entityType:u2};if(h2["com.sap.vocabularies.UI.v1.HeaderInfo"]&&u2){var v2=J1.getODataEntityType(u2,true)+"/com.sap.vocabularies.UI.v1.HeaderInfo";C1.headerInfoPath=v2;}if(h2["com.sap.vocabularies.UI.v1.QuickViewFacets"]&&u2){var x2=J1.getODataEntityType(u2,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";C1.quickViewFacetODataPath=x2;}return C1;}}}return C1;};var C1=B1();var D1=false;var E1=false;var F1=false;var G1=[];var H1=C.getOwnerComponent();var I1=H1.getModel();var J1=I1.getMetaModel();if(C1){if(C1.quickViewFacetODataPath){var K1=J1.createBindingContext(C1.quickViewFacetODataPath,true);var L1=K1&&K1.getModel().getObject(K1.getPath());if(L1){D1=true;for(var j=0;j<L1.length;j++){var M1=L1[j];if(M1&&M1.Target&&M1.Target.AnnotationPath){if(M1.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){E1=true;}else if(M1.Target.AnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){F1=true;G1.push(M1);}}}}}}if(D1){var N1,O1;N1=J1.getODataEntitySet(k.getEntitySet());O1=J1.getODataEntityType(N1.entityType);var P1=C1.headerInfoPath&&J1.createBindingContext(C1.headerInfoPath,true);var y1=x.mainNavigation;var Q1=x.semanticObject;var R1,S1;if(Q1&&y1){var T1=y1.getTarget&&y1.getTarget()||"";var U1=y1.getKey&&y1.getKey();if(U1){var V1=U1.split(Q1+"-");R1=V1&&V1[1];if(Q1&&R1){S1={"Target":T1,"SemanticObject":Q1,"Action":R1};}if(x.semanticAttributes){S1.SemanticAttributes=x.semanticAttributes;for(var i in x.semanticAttributes){var W1=x.semanticAttributes[i];if(W1.indexOf("{\"__deferred\":")>-1){delete S1.SemanticAttributes[i];}if(W1.indexOf("{\"__ref\":")>-1){delete S1.SemanticAttributes[i];}}if(S1.SemanticAttributes){var X1=JSON.stringify(S1.SemanticAttributes);if(X1&&X1.length>1){S1.SemanticAttributes=X1.substring(1,X1.length-1);}}}}}var Y1=J1.getODataProperty(O1,z1);var Z1=k&&k.mProperties&&k.mProperties.fieldSemanticObjectMap;var $1=new J({sourceClickedField:Y1,sourceEntityType:O1,showFieldGroup:E1,showContact:F1,ignoredFields:Z1,navigationPath:C1.navigation,mainNavigation:S1});$1.setDefaultBindingMode("OneWay");var _1={};_1.oState=w1;_1._templateEventHandlers={};_1._templateEventHandlers.onSemanticObjectLinkNavigationPressed=C._templateEventHandlers.onSemanticObjectLinkNavigationPressed.bind(C._templateEventHandlers);_1._templateEventHandlers.onDataFieldWithIntentBasedNavigation=C._templateEventHandlers.onDataFieldWithIntentBasedNavigation.bind(C._templateEventHandlers);_1.onInit=function(){};_1.onExit=function(){};_1.onAfterRendering=function(){var C=this;var a2=C.oView;var d2=a2.getParent().getParent().getParent();d2.setBusy(false);};_1.connectToView=C.connectToView.bind(_1);var a2=sap.ui.view({async:true,preprocessors:{xml:{bindingContexts:{sourceEntitySet:J1.createBindingContext(J1.getODataEntitySet(k.getEntitySet(),true)),entitySet:J1.createBindingContext(J1.getODataEntitySet(C1.entitySet,true)),header:P1,facetCollection:K1},models:{sourceEntitySet:J1,entitySet:J1,header:J1,facetCollection:J1,quickView:$1,parameter:o.getParameterModelForTemplating()}}},controller:_1,type:V.XML,viewName:"sap.suite.ui.generic.template.fragments.QuickViewSmartForm",height:"100%"});x.show(undefined,undefined,undefined,a2);var b2=function(d2){var e2=d2.getSource();if(e2){var f2=e2.getParent().getParent().getParent();f2.setBusy(true);f2.setBusyIndicatorDelay(10);}};a2.attachBeforeRendering(b2.bind(this));var c2=function(d2){var e2=d2.getSource();if(e2){var f2=e2.byId("ownTitleArea");if(f2){var g2=e2.getParent();if(g2&&g2.getItems){var h2=g2.getItems()&&g2.getItems()[0];if(h2&&h2!=e2){h2.setVisible(false);}}}if(F1&&G1&&f2){H(e2,G1);}}};a2.attachAfterRendering(c2.bind(this));}else{x.show(x1,y1,undefined,undefined);}}function P(C,i){var x=C.getView&&C.getView().getBindingContext();var w1=x.getObject();var x1=C.getOwnerComponent().getModel().getMetaModel();var y1=x1.getODataEntitySet(C.getOwnerComponent().getEntitySet());var z1=x1.getODataEntityType(y1.entityType);var A1=z1["com.sap.vocabularies.Common.v1.SemanticKey"];var B1={};if(A1&&A1.length>0){for(var j=0;j<A1.length;j++){var C1=A1[j].PropertyPath;if(!B1[C1]){B1[C1]=[];B1[C1].push(w1[C1]);}}}else{for(var k in z1.key.propertyRef){var D1=z1.key.propertyRef[k].name;if(!B1[D1]){B1[D1]=[];B1[D1].push(w1[D1]);}}}return B1;}function Q(k,i,x,w1){if(k[i].entitySet==x&&w1===k[i].navigationProperty&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].entitySet==x&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].pages){for(var j=0;j<(k[i].pages.length);j++){var x1=Q(k[i].pages,j,x,w1);if(x1!==undefined&&x1!==null){return x1;}}}}function R(i){var j=i.getSource().getTable();var k=i.getSource().getEntitySet();var x=i.getSource().getTableBindingPath();var w1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");var x1=C.getOwnerComponent().getAppComponent().getConfig().pages;var y1=Q(x1,0,k,x);if(y1!==undefined&&y1!==null&&w1){var z1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app").crossNavigation.outbounds[y1];if(z1){var A1=z1.semanticObject;var B1=z1.action;var C1=C.getView().getModel("_templPriv");var D1=C1.getProperty("/generic/supportedIntents/");var E1=(x==="")?k:k+"::"+x;var F1=C1.getProperty("/generic/supportedIntents/"+A1+"/"+B1+"/"+E1);if(!F1){var G1={},H1;var I1=C.getOwnerComponent().getAppComponent();for(var J1 in z1.parameters){if(!q.isEmptyObject(z1.parameters[J1])){G1[J1]=z1.parameters[J1];}}if(C.getMetadata().getName()==='sap.suite.ui.generic.template.ObjectPage.view.Details'){H1=P(C,I1);}var K1={semanticObject:A1,action:B1};var L1=q.extend({},H1,G1);var M1={target:K1,params:L1};var N1=w1.isNavigationSupported([M1],I1);N1.done(function(O1){var P1=C1.getProperty("/generic/supportedIntents/"+A1);if(!P1){D1[A1]={};D1[A1][B1]={};D1[A1][B1][E1]={"supported":O1[0].supported};}else if(!P1[B1]){P1[B1]={};P1[B1][E1]={"supported":O1[0].supported};}else{P1[B1][E1]={"supported":O1[0].supported};}C1.updateBindings();if(O1[0].supported&&f.isUiTable(j)){var Q1=j.getRowActionTemplate();Q1.getItems()[0].setVisible(true);j.setRowActionTemplate(Q1);}});}}}}function U(i){f.setEnabledToolbarButtons(i.getSource());R(i);}function W(i,j){if(!o.isDraftEnabled()||!i){return;}var k=i.getControlByKey("EditState");var x=k&&k.getSelectedKey()||"";switch(x){case"1":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":j.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var w1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(j.filters[0]&&j.filters[0].aFilters){var x1=j.filters[0];j.filters[0]=new F([x1,w1],true);}else{j.filters.push(w1);}break;}}function X(i,w1){var x1=i.getSource();var y1=x1.getTable();if(y1 instanceof T){var z1=y1.getColumns();for(var A1=0;A1<z1.length;A1++){if(z1[A1].getCustomData()[0].getValue()&&z1[A1].getCustomData()[0].getValue()["actionButton"]==="true"){z1[A1].setPopinDisplay("WithoutHeader");}}}var B1=i.getParameter("bindingParams");B1.parameters=B1.parameters||{};if(x1.data().allowSearch){B1.parameters["custom"]={"search":i.getSource().data().searchString};x1.data("allowSearch",false);}else if(x1.getBindingContext()&&x1.getBindingContext().getPath()===x1.data().objectPath){if(x1.getId()===x1.data().tableId){if(!!i.getSource().data().searchString){B1.parameters["custom"]={"search":i.getSource().data().searchString};}}}if(x1.data().allowSearchWorkListLight){B1.parameters["custom"]={"search":i.getSource().data().searchString};x1.data("allowSearchWorkListLight",false);if(!!i.getSource().data().searchString){B1.parameters["custom"]={"search":i.getSource().data().searchString};}}var C1=C.byId(x1.getSmartFilterId());if(!C1&&C.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'){C1=C.byId("listReportFilter");var D1=C1.getBasicSearchValue();if(!!D1){B1.parameters["custom"]={"search":D1};}}W(C1,B1);p(x1.getEntitySet(),B1);var E1=B1.parameters.select&&B1.parameters.select.split(",")||[];var F1=B1.parameters&&B1.parameters.expand&&B1.parameters.expand.split(",")||[];var G1=x1.getEntitySet();if(E1&&E1.length>0){var H1=x1.getModel().getMetaModel();var I1=H1.getODataEntitySet(G1);var J1={};var K1=H1.getODataEntityType(I1.entityType);for(var L1=0;L1<E1.length;L1++){var M1=E1[L1];if(M1){var J1=H1.getODataProperty(K1,M1);if(J1&&J1["com.sap.vocabularies.Common.v1.FieldControl"]&&J1["com.sap.vocabularies.Common.v1.FieldControl"].Path){var N1=J1["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(N1!==" "&&B1.parameters.select.search(N1)===-1){B1.parameters.select+=","+N1;E1.push(N1);}}}}if(y1 instanceof T){var O1=B1.sorter[0];if(O1&&O1.vGroup){var P1=m.getODataProperty(H1,K1,O1.sPath);var Q1=P1["com.sap.vocabularies.Common.v1.Text"]&&P1["com.sap.vocabularies.Common.v1.Text"].Path;if(Q1){if(q.inArray(Q1,E1)===-1){B1.parameters.select+=","+Q1;E1.push(Q1);}}}}var R1=I1["Org.OData.Capabilities.V1.DeleteRestrictions"];if(R1&&R1.Deletable&&R1.Deletable.Path&&B1.parameters.select.search(R1.Deletable.Path)===-1){B1.parameters.select+=","+R1.Deletable.Path;E1.push(R1.Deletable.Path);}var S1=I1["Org.OData.Capabilities.V1.UpdateRestrictions"];if(S1&&S1.Updatable&&S1.Updatable.Path&&B1.parameters.select.search(S1.Updatable.Path)===-1){B1.parameters.select+=","+S1.Updatable.Path;E1.push(S1.Updatable.Path);}var T1,U1;var K1=H1.getODataEntityType(I1.entityType);var V1=K1["com.sap.vocabularies.UI.v1.LineItem"]||[];var W1=K1["com.sap.vocabularies.UI.v1.LineItem"];var X1="com.sap.vocabularies.UI.v1.Criticality";var Y1=x1.getCustomData();for(var x=0;x<Y1.length;x++){if(Y1[x].getKey()&&Y1[x].getKey()==="lineItemQualifier"){var Z1=Y1[x].getValue();if(Z1){W1=K1["com.sap.vocabularies.UI.v1.LineItem#"+Z1];X1="com.sap.vocabularies.UI.v1.Criticality#"+Z1;break;}}}if(W1&&X1&&W1[X1]&&W1[X1].Path){E1.push(W1[X1].Path);B1.parameters.select+=","+W1[X1].Path;}for(var L1=0;L1<V1.length;L1++){if(V1[L1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){T1=H1.getODataFunctionImport(V1[L1].Action.String,true);if(T1){U1=H1.getObject(T1);if(U1["sap:action-for"]!==" "&&U1["sap:applicable-path"]!==" "&&B1.parameters.select.search(U1["sap:applicable-path"])===-1){B1.parameters.select+=","+U1["sap:applicable-path"];E1.push(U1["sap:applicable-path"]);}}}if(V1[L1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||V1[L1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){var $1,_1;if(V1[L1].Value&&V1[L1].Value.Path){$1=H1.getODataProperty(K1,V1[L1].Value.Path);if($1){_1=$1["sap:text"]||($1["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";}if(!_1){_1=V1[L1].Value.Path;}if(E1.indexOf(_1)===-1){E1.push(_1);B1.parameters.select=B1.parameters.select+","+_1;}}}if(V1[L1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(V1[L1].Target&&V1[L1].Target.AnnotationPath){var a2=V1[L1].Target.AnnotationPath;var b2=a2.split("@")[1];var c2=K1[b2];if(c2&&c2.MeasureAttributes){if(c2.MeasureAttributes[0]&&c2.MeasureAttributes[0].DataPoint&&c2.MeasureAttributes[0].DataPoint.AnnotationPath){var d2=c2.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var e2=K1[d2];if(e2){for(var f2 in e2){if(e2[f2]&&e2[f2].Path&&E1.indexOf(e2[f2].Path)===-1){B1.parameters.select=B1.parameters.select+","+e2[f2].Path;E1.push(e2[f2].Path);}if(f2==="CriticalityCalculation"&&e2.CriticalityCalculation){for(var g2 in e2.CriticalityCalculation){if(e2.CriticalityCalculation[g2].Path&&E1.indexOf(e2.CriticalityCalculation[g2].Path)===-1){B1.parameters.select=B1.parameters.select+","+e2.CriticalityCalculation[g2].Path;E1.push(e2.CriticalityCalculation[g2].Path);}}}}}}}if(c2&&c2.Measures){if(c2.Measures[0]&&c2.Measures[0].PropertyPath&&E1.indexOf(c2.Measures[0].PropertyPath)===-1){B1.parameters.select=B1.parameters.select+","+c2.Measures[0].PropertyPath;E1.push(c2.Measures[0].PropertyPath);}}}}}var h2=f.getBreakoutActionsForTable(x1,C);var i2=f.getBreakoutActionsFromManifest(y1.getModel(),x1);for(var j2 in i2){if(q.inArray(i2[j2].id,h2)!==-1){if(i2[j2].requiresSelection&&i2[j2].applicablePath){if(B1.parameters.select.search(i2[j2].applicablePath)===-1){B1.parameters.select+=","+i2[j2].applicablePath;E1.push(i2[j2].applicablePath);}}}}}I(E1,F1);var k2=s.oDraftController.getDraftContext();if(k2.isDraftEnabled(G1)&&k2.isDraftRoot(G1)){if(k2.hasDraftAdministrativeData(G1)){if(E1&&E1.length>0){if(E1.indexOf("DraftAdministrativeData")===-1){E1.push("DraftAdministrativeData");B1.parameters.select=B1.parameters.select+",DraftAdministrativeData";}}if(F1.indexOf("DraftAdministrativeData")===-1){F1.push("DraftAdministrativeData");}}}if(F1.length>0){B1.parameters.expand=F1.join(",");}var l2=x1.getCustomData();var m2={};for(var k=0;k<l2.length;k++){m2[l2[k].getKey()]=l2[k].getValue();}var n2=x1.fetchVariant();if(!m2.TemplateSortOrder&&w1&&w1.determineSortOrder){m2.TemplateSortOrder=w1.determineSortOrder();}if((!n2||!n2.sort)&&y1 instanceof T&&m2.TemplateSortOrder){var o2=m2.TemplateSortOrder.split(", ");for(var j=0;j<o2.length;j++){var p2=o2[j].split(" ");if(p2.length>1){B1.sorter.push(new b(p2[0],p2[1]==="true"));}else{B1.sorter.push(new b(p2[0]));}}}if(y1 instanceof T){var O1=B1.sorter[0];if(O1&&O1.vGroup){var q2;for(var A1=0;A1<z1.length;A1++){for(var r2=0;r2<z1[A1].getCustomData().length;r2++){var m2=z1[A1].getCustomData()[r2];if(m2.getProperty("key")==="p13nData"&&m2.getValue("p13nData").leadingProperty&&m2.getValue("p13nData").leadingProperty===O1.sPath){q2=z1[A1].getHeader().getProperty("text");O1.fnGroup=g(O1.sPath,q2);return;}}}}}}function Y(i,j,k){k=k||i.getBindingContext();f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){G(i,k,j.oSmartFilterbar);return;}var x=f.getOwnerControl(i);n(i);f.navigateFromListItem(k,x);},q.noop,j);}function Z(i){s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore incorrect selection, since app is busy anyway");return;}var j=i?"ST_GENERIC_MULTIPLE_ITEMS_SELECTED":"ST_GENERIC_NO_ITEM_SELECTED";M.error(f.getText(j),{styleClass:f.getContentDensityClass()});});}function $(i,j){var k=i.getParent().getParent().getTable();var x=f.getSelectedContexts(k);if(x.length===1){f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){G(i,x[0],j.oSmartFilterbar);return;}n(i);f.navigateFromListItem(x[0],k);},q.noop,j);}else{Z(x.length);}}function _(k){var x,w1,i,x1;var y1=C.getOwnerComponent(),z1=k.getSource().getCustomData(),A1="10rem";if(z1.length===0){return;}for(i=0,x1=z1.length;i<x1;i++){if(z1[i].getProperty("key")==="Target"){x=z1[i].getProperty("value");break;}}if(!x){M.show(f.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:f.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:A1,details:f.getText("ST_GENERIC_ERROR_IN_NAVIGATION_PROPERTY_MISSING",["DataFieldWithNavigationPath"])});return;}var B1=y1.getModel(),C1=B1.getMetaModel();var D1=k.getSource().getBindingContext().getPath(),E1=D1.slice(1,D1.indexOf("(")),F1=D1.slice(D1.indexOf("(")),G1=y1.getEntitySet(),H1=false;if(G1!==E1){G1=E1;H1=true;}var I1=C1.getODataEntitySet(G1),J1=C1.getODataEntityType(I1.entityType),K1=f.getNavigationKeyProperties(G1),j,L1,M1=false;L1=J1.navigationProperty.length;for(j=0;j<L1;j++){if(J1.navigationProperty[j].name===x){M1=true;break;}}if(!M1){M.show(f.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:f.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:A1,details:f.getText("ST_GENERIC_ERROR_NAVIGATION_PROPERTY_NOT_CORRECT",[x,"DataFieldWithNavigationPath"])});return;}var N1=o.getCurrentKeys();w1="/"+K1[K1.length-1].entitySet+"("+N1[K1.length]+")";if(H1){w1=w1.replace("(undefined)",F1);}var O1=C1.getODataAssociationEnd(J1,x),P1=C1.getODataEntityType(O1.type),Q1,R1;if(P1){Q1=P1.namespace+"."+P1.name;}var S1=C1.getODataEntityContainer().entitySet;for(i=0,x1=S1.length;i<x1;i++){if(S1[i].entityType===Q1){R1=S1[i].name;break;}}if(!R1){var T1=Q1.split(".")[1];T1=T1.slice(0,T1.length-4);M.show(f.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:f.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:A1,details:f.getText("ST_NAV_ERROR_TARGET_ENTITYSET_IS_MISSING",[T1])});return;}var U1=f.getNavigationKeyProperties(R1),V1=s.oNavigationController,W1={"$expand":""};if(o.isDraftEnabled()){W1={"$expand":"DraftAdministrativeData"};}var X1=new Promise(function(Y1,Z1){B1.read(w1+"/"+x,{urlParameters:W1,success:function($1){Y1($1);s.oApplication.invalidatePaginatorInfo();var _1=f.mergeNavigationKeyPropertiesWithValues(U1,$1);s.oApplication.setStoredTargetLayoutToFullscreen(1);V1.navigateToContext(_1,null,false);},error:function($1){Z1($1);}});});o.getBusyHelper().setBusy(X1);}function a1(i,j){var k=i.getSource();var x=f.getOwnerControl(k);var w1=f.getSelectedContexts(x);if(w1.length>1){Z(w1.length);}else{f.processDataLossConfirmationIfNonDraft(function(){var x1={action:k.data("Action"),semanticObject:k.data("SemanticObject")};N(x1,w1[0],j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}}function b1(i,j){var k=i.getSource();var x=k.getParent().getBindingContext();var w1=k.data("SemanticObject");var x1=k.data("Action");f.processDataLossConfirmationIfNonDraft(function(){var y1={action:x1,semanticObject:w1};N(y1,x,j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}function c1(i,j,k){f.processDataLossConfirmationIfNonDraft(function(){var x={action:j.Action,semanticObject:j.SemanticObject};N(x,i,k.oSmartFilterbar,k.oSmartTable);},q.noop,k);}function d1(i,j,k){var x=f.getElementCustomData(i);var w1=f.getSelectedContexts(j);var x1=!(x.RequiresContext&&x.RequiresContext==="false");if(x1&&w1.length!==1){Z(w1.length);}else{var y1=x1?w1[0]:null;c1(y1,x,k);}}function e1(i,j){f.processDataLossConfirmationIfNonDraft(function(){var k={semanticObject:i.data("SemanticObject"),action:i.data("Action")};var x=i.getParent().getBindingContext();N(k,x,j.oSmartFilterbar,j.oSmartTable);},q.noop,j);}function f1(i,j){var k=i.getSource();var x=f.getOwnerControl(k).getParent();var w1=[k.getBindingContext()];var x1=f.getElementCustomData(k);var y1=x.getTableBindingPath();f.triggerAction(w1,y1,x1,x,j);}function g1(i,j){var k=C.getView();var x=j?f.getSelectedContexts(j):[k.getBindingContext()];if(x.length===0){Z(x.length);}else{var w1=i.getSource();var x1=f.getElementCustomData(w1);var y1=j?j.getTableBindingPath():k.getBindingPath();f.triggerAction(x,y1,x1,j);}}function h1(i,j){var k,x="";var w1=f.getOwnerControl(i.getSource());var x1=i.getSource().data();var y1=f.getSelectedContexts(w1);if(f.isSmartTable(w1)){k=w1.getTable();x=w1.getTableBindingPath();}else if(f.isSmartChart(w1)){k=w1.getChart();x=w1.getChartBindingPath();}var z1=j1(y1,x1);if(z1.inApplicableCount>0&&(f.isSmartTable(w1)&&((k.getMode&&k.getMode()==="MultiSelect")||(k.getSelectionMode&&k.getSelectionMode()==="MultiToggle")))){var A1=f.getText("ST_GENERIC_WARNING_TEXT",[z1.inApplicableCount]);z1.warningText=A1;var B1={functionImportPath:x1.Action,contexts:z1.aApplicableContexts,sourceControl:k,label:x1.Label,operationGrouping:x1.InvocationGrouping,navigationProperty:"",sBindingPath:x,oState:j};var C1=i1(w1);var D1=C1.getModel("Action");D1.setData(B1);var E1=new sap.ui.model.json.JSONModel(z1);C1.setModel(E1,"list");var F1=C1.getModel("list");F1.setData(z1);C1.open();}else{k1({functionImportPath:x1.Action,contexts:y1,sourceControl:k,label:x1.Label,operationGrouping:x1.InvocationGrouping,navigationProperty:""},j,x);}}function i1(i){return f.getDialogFragment("sap.suite.ui.generic.template.fragments.ActionConfirmation",{onCancel:function(j){var k=j.getSource().getParent();k.close();},onContinue:function(j){var k=j.getSource().getParent();var x=j.getSource().getParent().getModel("Action").getData();k1({functionImportPath:x.functionImportPath,contexts:x.contexts,sourceControl:x.sourceControl,label:x.label,operationGrouping:x.operationGrouping,navigationProperty:x.navigationProperty},x.oState,x.sBindingPath);k.close();}},"Action");}function j1(j,k){var x,w1,x1,y1;var z1=C.getView().getModel();var A1=z1.getMetaModel();if(j&&j.length>0){x1=j[0].sPath.substring(1,j[0].sPath.indexOf('('));y1=A1.getODataEntitySet(x1);}if(y1){var B1=k.Action.split("/")[1];var C1=[],D1=[];var E1={aInApplicableItems:undefined,inApplicableCount:0,dialogTitle:k.Label,warningText:undefined,aApplicableContexts:undefined};if(B1){w1=A1.getODataFunctionImport(B1)["sap:applicable-path"];}for(var i=0;i<j.length;i++){x=z1.getObject(j[i].getPath());if(!x[w1]){E1.inApplicableCount++;var F1=A1.getODataEntityType(A1.getODataEntitySet(x1).entityType);var G1=F1["com.sap.vocabularies.UI.v1.HeaderInfo"].Title.Value.Path;C1.push({sKey:x[G1]});}else{D1.push(j[i]);}}E1.aInApplicableItems=C1;E1.aApplicableContexts=D1;}return E1;}function k1(i,j,k){var x;f.processDataLossConfirmationIfNonDraft(function(){s.oCRUDManager.callAction({functionImportPath:i.functionImportPath,contexts:i.contexts,sourceControl:i.sourceControl,label:i.label,operationGrouping:i.operationGrouping,navigationProperty:i.navigationProperty},j).then(function(w1){if(w1&&w1.length&&w1.length===1){x=w1[0];if(x.response&&x.response.context&&(!x.actionContext||x.actionContext&&x.response.context.getPath()!==x.actionContext.getPath())){s.oApplication.getBusyHelper().getUnbusy().then(s.oViewDependencyHelper.setMeToDirty.bind(null,C.getOwnerComponent(),k));}}});},q.noop,j,"Proceed");}var l1;var m1;function n1(i){l1=true;m1=i;var j=f.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){q.sap.log.info("Draft cancellation confirmed");if(!l1){q.sap.log.info("Draft popover no longer active -> Ignore.");return;}m1();}},"discard");return j;}function o1(i,j){var k=new Promise(function(w1,x1){i.then(function(y1){q.sap.log.info("Active information for current draft has been read. Start discarding the draft");var z1=y1&&y1.getObject();var A1=z1&&z1.IsActiveEntity;var B1=A1?s.oApplication.getTargetAfterCancelPromise(y1):Promise.resolve();B1.then(function(C1){var D1=s.oCRUDManager.deleteEntity(false,true);if(!C1){s.oApplication.prepareDeletionOfCreateDraft(D1);}D1.then(function(){q.sap.log.info("Draft was discarded successfully");j();s.oViewDependencyHelper.setRootPageToDirty();s.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());s.oApplication.invalidatePaginatorInfo();if(C1){q.sap.log.info("Navigate to active entityy");s.oNavigationController.navigateToContext(C1,null,true,1);}w1();},x1);},x1);},x1);});var x={discardPromise:k};o.fire(C,"AfterCancel",x);s.oApplication.getBusyHelper().setBusy(k);k.catch(j);return k;}function p1(i){var j=l();s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore discarding confirmation as app is already busy");return;}var k=C.getView().getBindingContext();var x=k.getObject();var w1=x.hasOwnProperty("HasActiveEntity")&&!k.getProperty("IsActiveEntity")&&!k.getProperty("HasActiveEntity");var x1=k&&k.getPath();var y1=s.oApplication.getIsDraftModified(x1);if(y1){var z1=i.getSource();var A1;var B1=function(){l1=false;A1.close();q.sap.log.info("Draft popover closed");};A1=n1(o1.bind(null,j,B1));var C1=A1.getModel("discard");C1.setProperty("/placement",sap.m.PlacementType.Top);C1.setProperty("/isCreateDraft",w1);A1.openBy(z1);}else{o1(j,q.noop);}});}function q1(){if(o.getViewLevel()!==1||!o.isDraftEnabled()){q.sap.log.warning("Discard draft only possible on root level of draft enabled entities");return Promise.reject();}var i=C.getOwnerComponent();if(!(o.isComponentActive()&&i.getModel("ui").getProperty("/editable"))){q.sap.log.warning("Discard draft only possible in edit mode");return Promise.reject();}var j=l();return o1(j,q.noop);}function r1(i,j,k,x){if(i.data("CrossNavigation")){G(i,i.getBindingContext(),k);return new Promise(function(A1){A1();});}var w1=f.getOwnerControl(i);var x1=w1.getTableBindingPath();var y1=C.getOwnerComponent();var z1=function(A1){var B1=s.oCRUDManager.addEntry(w1,A1).then(function(C1){if(!j){s.oNavigationController.navigateToContext(C1.newContext,C1.tableBindingPath,false,4);s.oApplication.getBusyHelper().getUnbusy().then(s.oViewDependencyHelper.setMeToDirty.bind(null,y1,x1));}else{f.refreshSmartTable(w1);s.oApplicationController.executeSideEffects(y1.getBindingContext(),[],[x1]);}});B1.catch(q.noop);return B1;};if(x instanceof Promise){return x.then(z1);}else{return z1(x);}}function s1(i){var j=f.getOwnerControl(i.getSource());var k=f.getSelectedContexts(j);if(k&&k.length>0){var x=y(k);var w1=v(j);var x1=w1.getModel("delete");x.then(function(x){x1.setData(x.mJSONData);w1.open();});}else{M.error(f.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:f.getContentDensityClass()});}}function t1(i){var j;if(i.getSource().data("Location")==="Header"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="Section"){j=i.getSource().getParent().getElements()[1];}else if(i.getSource().data("Location")==="SmartTable"){j=i.getSource().getParent().getAggregation("items")[0];}else{j=i.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}j.bindElement(i.getSource().getBindingContext().getPath());j.openBy(i.getSource());}function u1(i,j){var k=i.getSource();var x=i.getParameter("bindingParams");x.parameters=x.parameters||{};v1(i,k,x);}function v1(i,j,k){var x=C.byId("listReportFilter");W(x,k);var w1=j.getEntitySet();p(w1,k);}var z=t.testable(z,"fnBuildSelectionVariantForNavigation");var E=t.testable(E,"fnEvaluateParameters");var N=t.testable(N,"fnNavigateIntent");var H=t.testable(H,"fnHideTitleArea");return{onDataReceived:U,onBeforeRebindTable:X,onListNavigate:Y,onShowDetails:$,onEditNavigateIntent:G,onSemanticObjectLinkPopoverLinkPressed:K,onDataFieldWithNavigationPath:_,onDataFieldForIntentBasedNavigation:a1,onDeterminingDataFieldForIntentBasedNavigation:d1,onDeterminingDataFieldForAction:g1,onInlineDataFieldForIntentBasedNavigation:e1,onDataFieldWithIntentBasedNavigation:b1,onInlineDataFieldForAction:f1,onSmartFieldUrlPressed:r,onBreadCrumbUrlPressed:u,onCallActionFromToolBar:h1,onDiscardDraft:p1,discardDraftWithoutDialog:q1,addEntry:r1,deleteEntries:s1,onContactDetails:t1,onSemanticObjectLinkNavigationTargetObtained:L,onSemanticObjectLinkNavigationPressed:O,onBeforeRebindChart:u1};}return B.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(C,o,s,f){q.extend(this,e(C,o,s,f));}});});
