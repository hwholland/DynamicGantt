(function(){"use strict";jQuery.sap.require("sap.ui.comp.smartfield.SmartField");jQuery.sap.require("sap.suite.ui.generic.template.extensionAPI.UIMode");var U=sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelper");sap.suite.ui.generic.template.js.AnnotationHelper={formatIndicatorValue:function(v){return parseFloat(v);},ratingIndicatorFormatter:function(d,v){var t;if(d.Value.Decimal){t=d.Value.Decimal;}else{t=d.Value.Path;}return"{parts: [{path: '"+t+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatIndicatorValue'}";},createProgressFormatter:function(d,v){var D,V;if(!d.Value){return;}if(d.TargetValue){D=d.TargetValue.Path;}if(v["Org.OData.Measures.V1.Unit"]){V=v["Org.OData.Measures.V1.Unit"].Path;}else if(v["Org.OData.Measures.V1.ISOCurrency"]){V=v["Org.OData.Measures.V1.ISOCurrency"].Path;}return"{parts: [{path: '"+d.Value.Path+"'}, {path: '"+D+"'}, {path: '"+V+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.calcProgressPerc'}";},calcProgressPerc:function(v,t,u){var p;var d;if(!t){t=this.data("fixTargetValue");}var r=this.getModel("i18n").getResourceBundle();if(u==="%"){p=parseFloat(v);d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_PERCENT",[v]);}else if(v&&t){if(t!=="0"){p=(parseFloat(v)/parseFloat(t))*100;}else{p=0;}if(u){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT",[v,t,u]);}else{d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[v,t]);}}else{p=0;if(u){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT_NO_TARGET_VALUE",[v,u]);}else{d=v;}}if(p>100){p=100;}this.setDisplayValue(d);return p;},createProgressStateFormatter:function(d,D){var c=(d)?d:D;if(!c&&!c.Path){return"";}return"{path: '"+c.Path+"', formatter:'sap.suite.ui.generic.template.js.AnnotationHelper.formatProgressState'}";},formatProgressState:function(c){if(c==="1"||c==="com.sap.vocabularies.UI.v1.CriticalityType/Negative"){return sap.ui.core.ValueState.Error;}else if(c==="2"||c==="com.sap.vocabularies.UI.v1.CriticalityType/Critical"){return sap.ui.core.ValueState.Warning;}else if(c==="3"||c==="com.sap.vocabularies.UI.v1.CriticalityType/Positive"){return sap.ui.core.ValueState.Success;}else{return sap.ui.core.ValueState.None;}},getIdForMoreBlockContent:function(f){if(f["com.sap.vocabularies.UI.v1.PartOfPreview"]&&f["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){return"::MoreContent";}},checkMoreBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,false);},checkBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,true);},checkFacetContent:function(f,b){var p;var i=f.getInterface(0);var F=f.getModel().getProperty("",f);var a=f.getPath().split("/Facets");var c=i.getModel().getContext(a[0]);if(i.getModel().getProperty('',c).RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){return c.getPath();}else{if(!F){return;}for(var d=0;d<F.length;d++){if(!b){if(F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]&&F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){p=i.getPath()+"/"+d;break;}}else{if(F[d].RecordType!=="com.sap.vocabularies.UI.v1.ReferenceFacet"||(!F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]||F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true")){p=i.getPath()+"/"+d;break;}}}}return p;},isImageUrl:function(p){var s=p["com.sap.vocabularies.UI.v1.IsImageURL"]||p["com.sap.vocabularies.UI.v1.IsImageUrl"];if(s&&s.Bool&&s.Bool==="false"){return false;}else if(s){return true;}return false;},hasBreadCrumbs:function(I,v){if(v){var s=v.split("/");var p="",b=[],d;s.pop();if(s.length>0){for(var i=0;i<s.length;i++){p=(p)?(p+"/"+s[i]):s[i];b.push(p);}d=I.getSetting("preprocessorsData");d.breadCrumbs=b;return true;}}},matchesBreadCrumb:function(I,c,p){if(p){var s=p.split("/");var e,E,a;if(s.length>0){var m=I.getInterface(0).getModel();var b=s[0];for(var i=0;i<s.length;i++){if(i>0){e=m.getODataEntitySet(b);E=m.getODataEntityType(e.entityType);a=m.getODataAssociationSetEnd(E,s[i]);b=a.entitySet;}if((i+1)===s.length){if(b===c.name){return true;}else{return false;}}}}}},isObjectPageWithoutComplexTable:function(e,r,f){if(f&&!sap.suite.ui.generic.template.js.AnnotationHelper.isOrHasComplexTable(e,r,f)){return true;}return false;},isOrHasComplexTable:function(e,r,f){if(r){var m=r.pages;}if(m&&f){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return sap.suite.ui.generic.template.js.AnnotationHelper._hasComplexTableForFacetId(e,m,F);}else{return sap.suite.ui.generic.template.js.AnnotationHelper.isComplexTable(r);}},showFullScreenButton:function(r,f){if(r&&f){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(r.component&&r.component.settings&&r.component.settings.sections&&r.component.settings.sections[F]&&r.component.settings.sections[F].tableMode==="FullScreenTable"){return true;}}return false;},_hasComplexTableForFacetId:function(e,m,f){for(var i in m){var p=m[i];if(p.entitySet&&p.component&&p.component.settings&&p.component.settings.complexListId){if(p.navigationProperty&&p.entitySet===e&&p.component.settings.complexListId===f&&p.component.list){return true;}}if(p.pages){var r=sap.suite.ui.generic.template.js.AnnotationHelper._hasComplexTableForFacetId(e,p.pages,f);}if(r===true){return true;}}return false;},isComplexTable:function(r){if(r&&r.component&&r.component.list&&r.component.settings&&r.component.settings.complexListId&&r.navigationProperty){return true;}return false;},getPersistencyKeyForSmartTable:function(r){if(sap.suite.ui.generic.template.js.AnnotationHelper.isComplexTable(r)){return r.component.settings.complexListId;}return"listReportFloorplanTable";},getDisplayNavigationIntent:function(l,s,a){return sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l,s,a,'display');},getSubObjectPageIntent:function(l,s,a,m){var n;if(a){n=a.split("/")[0];}if(l&&s&&s.length>0){if(n){for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&n===s[i].navigationProperty&&s[i].navigation&&s[i].navigation[m]){return s[i].navigation[m].target;}}}else{for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&s[i].navigation&&s[i].navigation[m]){return s[i].navigation[m].target;}}}}},extensionPointFragmentExists:function(f,F){var i=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(i===F){return true;}else{return false;}},formatWithExpandSimple:function(i,d,e){var E=[],s,o;var m=i&&i.getModel&&i.getModel();if(!m){i=i.getInterface(0);m=i.getModel();}if(e){o=m.getODataEntityType(e.entityType);}else{var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(i.getPath());if(M&&M.length&&M[0]){var a=m.getProperty(M[0]);var n=m.getODataEntityContainer().namespace;o=m.getODataEntityType(n+'.'+a.name);}}if(o){if(d&&d.Path){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,d.Path);if(s){E.push(s);}}else if(d&&d.Apply&&d.Apply.Name==="odata.concat"){d.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,P.Value);if(s){if(E.indexOf(s)===-1){E.push(s);}}}});}if(E.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<E.length;j++){if(r.indexOf(E[j])===-1){r.push(E[j]);}}p.rootContextExpand=r;}}}return sap.ui.model.odata.AnnotationHelper.format(i,d);},formatWithExpand:function(i,d,e){sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand(i,d,e);i=i.getInterface(0);sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple(i,d,e);return sap.ui.model.odata.AnnotationHelper.format(i,d);},_getNavigationPrefix:function(m,e,p){var E="";var P=p.split("/");if(P.length>1){for(var i=0;i<(P.length-1);i++){var a=m.getODataAssociationEnd(e,P[i]);if(a){e=m.getODataEntityType(a.type);if(E){E=E+"/";}E=E+P[i];}else{return E;}}}return E;},getNavigationPathWithExpand:function(I,c,E){I=I.getInterface(0);var d=[],a=[],f,F=[];var m=I.getModel();var o=m.getODataEntitySet(E.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(I.getPath()));var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(I,c);var N=n.replace("{","").replace("}","");if(N){var b=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(b,N);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);}}else{var b=m.getODataEntityType(E.entityType);}if(r){F=m.getObject(r);}F=F.Data||F;var g=function(P,k){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,b,P);if(s){if(a.indexOf(s)===-1){a.push(s);}}if(k){try{d=sap.ui.comp.smartfield.SmartField.getSupportedAnnotationPaths(m,o,P,true)||[];}catch(e){d=[];}for(var i=0;i<d.length;i++){if(a.indexOf(d[i])===-1){a.push(d[i]);}}}};var h=function(P){if(P.Type==="LabeledElement"){g(P.Value.Path);}else if(P.Type==="Path"){g(P.Value);}};for(var i=0;i<F.length;i++){f=F[i];if(f.Value&&f.Value.Path){g(f.Value.Path,true);}if(f.Value&&f.Value.Apply&&f.Value.Apply.Name==="odata.concat"){f.Value.Apply.Parameters.forEach(h);}if(f.Action&&f.Action.Path){g(f.Action.Path);}if(f.Target&&f.Target.Path){g(f.Target.Path);}if(f.SemanticObject&&f.SemanticObject.Path){g(f.SemanticObject.Path);}if(f.Url&&f.Url.Path){g(f.Url.Path);}if(f.Url&&f.Url.Apply&&f.Url.Apply.Parameters){f.Url.Apply.Parameters.forEach(h);}if(f.UrlContentType&&f.UrlContentType.Path){g(f.UrlContentType.Path);}}if(F.name){g(F.name,true);}if(a.length>0){if(N===""){var p=I.getSetting("preprocessorsData");if(p){var R=p.rootContextExpand||[];for(var j=0;j<a.length;j++){if(R.indexOf(a[j])===-1){R.push(a[j]);}}p.rootContextExpand=R;}}else{n="{ path : '"+N+"', parameters : { expand : '"+a.join(',')+"'} }";}}return n;},isSelf:function(p){if(p===undefined||(p&&p.indexOf('@')===0&&p.indexOf('/')===-1)){return true;}return false;},number:function(v){if(!v){return NaN;}else if(v.Decimal){return+v.Decimal;}else if(v.Path){return'{'+v.Path+'}';}else{return NaN;}},formatColor:(function(){function f(v){if(!v){return NaN;}else if(v.Decimal){return v.Decimal;}else if(v.EnumMember){return'\''+v.EnumMember+'\'';}else if(v.Path){return'${'+v.Path+'}';}else{return NaN;}}function a(d){var c=d.Criticality;return'{= '+f(c)+' === \'UI.CriticalityType/Negative\' ? \'Error\' : '+f(c)+'=== \'UI.CriticalityType/Critical\' ? \'Critical\' : \'Good\'}';}function b(d){var v=f(d.Value);var c=d.CriticalityCalculation;return'{= ('+v+' < '+f(c.DeviationRangeLowValue)+' || '+v+' > '+f(c.DeviationRangeHighValue)+') ? \'Error\' : ('+v+' < '+f(c.ToleranceRangeLowValue)+' || '+v+' > '+f(c.ToleranceRangeHighValue)+') ? \'Critical\' : \'Good\'}';}return function(d){if(d.Criticality){return a(d);}else if(d.CriticalityCalculation){return b(d);}};})(),_determineColumnIndex:function(c){var C=c.getPath();var i=Number(C.slice(C.lastIndexOf("/")+1));var l=C.slice(0,C.lastIndexOf("/"));var L=c.getModel().getObject(l);for(var r=0;r<i;r++){if((L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&(!L[r].Inline||L[r].Inline.Bool==="false")){i--;}}return i;},createP13NColumnForAction:function(c,d){var C=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(c);var p='\\{"columnKey":"'+d.Label.String+'", "columnIndex":"'+C+'", "actionButton":"true" \\}';return p;},createP13NColumnForIndicator:function(i,c,C,d,D,o){var p=sap.suite.ui.generic.template.js.AnnotationHelper.createP13N(i,c,C,d,D,o);var O=p.slice(0,p.lastIndexOf("\\}")-1);var a=i.getInterface(2);var b=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(a);if(b){O+=', "columnIndex":"'+b;}O+='" \\}';return O;},createP13N:function(I,c,C,d,D,o){var p="",a=[],n="";if(d.RecordType==="com.sap.vocabularies.UI.v1.DataField"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&d.Target){if(D){if(d.Criticality){D.Criticality=d.Criticality;}if(D.TargetValue&&D.TargetValue.Path){a.push(D.TargetValue.Path);}d=D;C=o;}}if(d.Value.Path){var s=d.Value.Path;if(d.Visualization&&d.Visualization.EnumMember){s=s+d.Visualization.EnumMember.slice(d.Visualization.EnumMember.lastIndexOf("/")+1,d.Visualization.EnumMember.length);}p='\\{"columnKey":"'+s+'", "leadingProperty":"'+d.Value.Path;var m=I.getInterface(0).getModel("meta");if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,d.Value.Path);if(n){n=n+"/";}}}}else if(d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){d.Value.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){if(!p){p='\\{"columnKey":"'+P.Value+'", "leadingProperty":"'+P.Value;}else{a.push(P.Value);}}});}if((C.type==="Edm.DateTime")&&(C["sap:display-format"]==="Date")){p+='", "type":"date';}if(d.Criticality&&d.Criticality.Path){a.push(d.Criticality.Path);}if(C["com.sap.vocabularies.Common.v1.Text"]&&C["com.sap.vocabularies.Common.v1.Text"].Path){a.push(n+C["com.sap.vocabularies.Common.v1.Text"].Path);}if(C["Org.OData.Measures.V1.ISOCurrency"]&&C["Org.OData.Measures.V1.ISOCurrency"].Path){a.push(n+C["Org.OData.Measures.V1.ISOCurrency"].Path);}if(C["Org.OData.Measures.V1.Unit"]&&C["Org.OData.Measures.V1.Unit"].Path){a.push(n+C["Org.OData.Measures.V1.Unit"].Path);}if(C["com.sap.vocabularies.Common.v1.FieldControl"]&&C["com.sap.vocabularies.Common.v1.FieldControl"].Path){a.push(n+C["com.sap.vocabularies.Common.v1.FieldControl"].Path);}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Apply&&d.Url.Apply.Parameters){d.Url.Apply.Parameters.forEach(function(P){if(P.Type==="LabeledElement"){a.push(P.Value.Path);}});}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Path){a.push(d.Url.Path);}if(a.length>0){var A="";a.forEach(function(P){if(A){A=A+",";}A=A+P;});p+='", "additionalProperty":"'+A;}var N=false;if(c["Org.OData.Capabilities.V1.SortRestrictions"]&&c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties){var b=c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties;for(var i=b.length-1;i>=0;i--){if(b[i].PropertyPath===d.Value.Path){N=true;break;}}}if(!N){if(n){p+='", "sortProperty":"'+n+C.name;}else{p+='", "sortProperty":"'+C.name;}}var f=false;if(c["Org.OData.Capabilities.V1.FilterRestrictions"]){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].Filterable!=='false'){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties){var g=c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties;for(var j=g.length-1;j>=0;j--){if(g[j].PropertyPath===d.Value.Path){f=true;break;}}}}else{f=true;}}if(!f){p+='", "filterProperty":"'+C.name;}}else{p='\\{"columnKey":"'+d.Label.String;p+='", "actionButton":"true';}return p+'" \\}';},hasActions:function(P){for(var i=0;i<P.length;i++){if(P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true;}}return false;},hasCustomActions:function(r,e,m,f){if(e&&m){if(f){if(m[e]){var M=m[e];if(M.EntitySet===e){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var s=M.Sections[F];if(s&&s.id===F&&s.Actions){for(var i in s.Actions){if(s.Actions[i].requiresSelection!==false){return true;}}}}}}else{if(sap.suite.ui.generic.template.js.AnnotationHelper.isComplexTable(r)){m=m["sap.suite.ui.generic.template.ListReport.view.ComplexTable"]["sap.ui.generic.app"];}else{m=m["sap.suite.ui.generic.template.ListReport.view.ListReport"]["sap.ui.generic.app"];}if(m&&m[e]){var M=m[e];if(M.EntitySet===e){if(M.Actions){for(var i in M.Actions){if(M.Actions[i].requiresSelection!==false){return true;}}}}}}}return false;},getSelectionModeGridTable:function(e,r,m,f,E,R){var s="None";for(var i in R.pages){if(R.pages[i].entitySet===r&&sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(E,R.pages[i].pages)){s="Single";break;}}if(sap.suite.ui.generic.template.js.AnnotationHelper.isOrHasComplexTable(E.name,R,f)){return s;}if(sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f)){s="Single";}return s;},getSelectionModeResponsiveTable:function(e,r,m,f,E,R){var s="None";if(sap.suite.ui.generic.template.js.AnnotationHelper.isOrHasComplexTable(E.name,R,f)){return s;}if(sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f)){s="SingleSelectLeft";}return s;},getSortOrder:function(P){var s='';for(var i=0;i<P.length;i++){if(!s){s=P[i].Property.PropertyPath;}else{s=s+', '+P[i].Property.PropertyPath;}if(P[i].Descending){s=s+' '+P[i].Descending.Bool;}}return s;},replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace(/@/g,"").replace(/\//g,"::").replace(/#/g,"::");},getStableIdPartFromDataField:function(d){var p="",I="";if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(d.SemanticObject.String){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.String);}else if(d.SemanticObject.Path){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.Path);}if(d.Action&&d.Action.String){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.Action&&d.Action.Path){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.Path);}return I;}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Target.AnnotationPath);}else if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the annotations.");}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},getStableIdPartFromFacet:function(f){var h="";if(typeof this.getContext==="function"&&this.getContext()&&this.getContext().getPath()&&this.getContext().getPath().indexOf("com.sap.vocabularies.UI.v1.HeaderFacets")>=0){h="headerEditable::";}if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{return h+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(f.Target.AnnotationPath);}}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},extensionPointBeforeFacetExists:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m[E]){return"true";}else{return"";}},extensionPointAfterFacetExists:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m[E]){return"true";}else{return"";}},getExtensionPointBeforeFacetTitle:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getExtensionPointAfterFacetTitle:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getRepeatIndex:function(v){if(v&&v.getPath()){var p="0000000000";var P=p+((parseInt(v.getPath().substring(v.getPath().lastIndexOf("/")+1),10)+1)*10).toString();return P.substr(P.length-p.length);}else{jQuery.sap.log.error("Annotation Helper: Unable to get index.");}},getColumnListItemType:function(l,s){if(sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(l,s)){return"Navigation";}else{return"Inactive";}},hasSubObjectPage:function(l,s){var h=false;if(l.name&&s&&s.length>0){s.forEach(function(S){if(l.name===S.entitySet){if(!sap.suite.ui.generic.template.js.AnnotationHelper.isComplexTable(S)){h=true;}}});}return h;},actionControlHeader:function(i,a,e){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,a,e);if(a){return"{= !${ui>/editable} && ${path: '"+a+"'} }";}else{return"{= !${ui>/editable} }";}},actionControlFooter:function(i,a,e){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,a,e);if(a){return"{path: '"+a+"'}";}else{return"true";}},_actionControlExpand:function(i,a,e){var E=[],s;i=i.getInterface(0);var m=i.getModel();var o=m.getODataEntityType(e);if(a){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,a);if(s){E.push(s);}}if(E.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<E.length;j++){if(r.indexOf(E[j])===-1){r.push(E[j]);}}p.rootContextExpand=r;}}},getEntityTypesForFormPersonalization:function(i,f,e){i=i.getInterface(0);var E=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var F=[];if(f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"&&f.Facets){F=f.Facets;}else if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){F.push(f);}F.forEach(function(f){var n;if(f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("/")>0){n=f.Target.AnnotationPath.split("/")[0];var a=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(a,n);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);if(E.indexOf(o.entityType.split(".")[1])===-1){E.push(o.entityType.split(".")[1]);}}}else{if(E.indexOf(e.entityType.split(".")[1])===-1){E.push(e.entityType.split(".")[1]);}}});return E.join(", ");},formatHeaderTitle:function(i,d){return"{path: 'ui>/createMode', formatter: '._templateFormatters.formatDefaultObjectTitle'}";},getTextArrangementForSmartControl:function(i,v,e){i=i.getInterface(0);var m=i.getModel();var E=m.getODataEntityType(e.entityType);var t="descriptionAndId";if(E["com.sap.vocabularies.UI.v1.TextArrangement"]&&E["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){switch(E["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":t="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":t="idOnly";break;default:break;}}return t;},isDeepFacetHierarchy:function(f){if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){return true;}}}return false;},doesCollectionFacetOnlyContainForms:function(f){var r=true;if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].Target&&f.Facets[i].Target.AnnotationPath){if((f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.Identification")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.DataPoint")<0)){r=false;}}}}else{r=false;}return r;},doesFieldGroupContainOnlyOneMultiLineDataField:function(f,F){if(f.Data.length!==1){return false;}if((F['com.sap.vocabularies.UI.v1.MultiLineText']===undefined)||(f.Data[0].RecordType!=="com.sap.vocabularies.UI.v1.DataField")){return false;}return true;},testFormatter:function(v){return"formatted:"+v;},getFacetID:function(e,f){return e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);},reuseComponentForFacetExists:function(e,f,r){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetID(e,f);if(r[F]){return"true";}else{return"";}},getNameOfReuseComponentForFacet:function(e,f,r){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetID(e,f);return r[F].componentName;},formatComponentSettings:function(i,e,f,r){var t=i.getInterface(0),F=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetID(e.name,f),R=r[F];var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(t,f.Target);var N=n.replace("{","").replace("}","");return sap.suite.ui.generic.template.js.AnnotationHelper.formatComponentSettingsInt(i,e,R,N);},formatComponentSettingsInt:function(i,e,r,n){var t=i.getInterface(0),m=t.getModel(),E=m.getODataEntityType(e.entityType);n=n||r.binding;if(n){var a=m.getODataAssociationSetEnd(E,n);if(a&&a.entitySet){e=m.getODataEntitySet(a.entitySet);E=m.getODataEntityType(e.entityType);}}var s=sap.ui.model.odata.AnnotationHelper.format(t,e["com.sap.vocabularies.Common.v1.SemanticObject"]);var o="";E.key.propertyRef.forEach(function(k){o+="{"+k.name+"}::";});o=o.replace(/::$/,"");var b={"uiMode":"{= ${ui>/createMode} ? '"+U.Create+"' : ( ${ui>/editable} ? '"+U.Edit+"' : '"+U.Display+"') }","semanticObject":s||""};if(r){jQuery.extend(b,r.settings);var v=JSON.stringify(b);v=v.replace(/\}/g,"\\}").replace(/\{/g,"\\{");return v;}},isListReportTemplate:function(r){if(r){return r.template==="sap.suite.ui.generic.template.ListReport";}},getStableIdPartForDatafieldActionButton:function(d,f){var s="";var D="";var F="";if(f){F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);}if(d){D=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}s=(F!==""?F+"::":"")+"action::"+D;return s;}};sap.suite.ui.generic.template.js.AnnotationHelper.formatComponentSettingsInt.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatComponentSettings.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getRepeatIndex.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEntityTypesForFormPersonalization.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.actionControlHeader.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.actionControlFooter.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatHeaderTitle.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getTextArrangementForSmartControl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.matchesBreadCrumb.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.hasBreadCrumbs.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13N.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForIndicator.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForAction.requiresIContext=true;})();
